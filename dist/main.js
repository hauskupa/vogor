// Build version: 800157 (2025-11-11T18:30:00.157Z)
(()=>{function u(){let n={tracks:{},audioContext:null,isPlaying:!1,loadSong(e){if(this.stopAllTracks(),this.tracks={},!e.getAttribute("data-song")){console.error("Song ID not found");return}this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext),console.log("AudioContext initialized")),e.querySelectorAll("[data-track-url]").forEach(o=>{let r=o.getAttribute("data-track-id"),i=o.getAttribute("data-track-url");if(i&&!this.tracks[r]){let s=new Audio(i);s.crossOrigin="anonymous";try{let c=this.audioContext.createMediaElementSource(s),l=this.audioContext.createStereoPanner();c.connect(l),l.connect(this.audioContext.destination),console.log(`Track ${r} audio nodes connected`),this.tracks[r]={element:o,audio:s,panner:l,volumeControl:o.querySelector("[data-volume-control]"),panControl:o.querySelector("[data-pan-control]"),muteButton:o.querySelector("[data-mute-button]"),soloButton:o.querySelector("[data-solo-button]")},this.initTrackControls(r)}catch(c){console.error(`Failed to initialize audio track ${r}: ${c.message}`)}}})},initTrackControls(e){let t=this.tracks[e];if(!t){console.error(`Track ID ${e} not found or not loaded.`);return}t.volumeControl&&t.audio&&(t.volumeControl.addEventListener("input",a=>{let o=parseFloat(a.target.value);t.audio.volume=o,console.log(`Track ${e} volume set to: ${o}`)}),t.audio.volume=t.volumeControl.value),t.panControl&&t.panner&&t.panControl.addEventListener("input",a=>{let o=parseFloat(a.target.value);t.panner.pan.value=o,console.log(`Track ${e} panned to: ${o}`)}),t.muteButton&&t.muteButton.addEventListener("click",()=>{t.audio.muted=!t.audio.muted,t.muteButton.classList.toggle("mute-active",t.audio.muted)}),t.soloButton&&t.soloButton.addEventListener("click",()=>{let a=t.soloButton.classList.contains("solo-active");for(let o in this.tracks){let r=this.tracks[o];o!==e&&(r.audio.muted=!a)}t.soloButton.classList.toggle("solo-active",!a)})},playAllTracks(){let e=[];for(let t in this.tracks){let a=this.tracks[t],o=new Promise(r=>{a.audio.addEventListener("canplaythrough",()=>{console.log(`Track ${t} ready to play`),r()})});e.push(o)}Promise.all(e).then(()=>{console.log("All tracks are ready. Playing now...");for(let t in this.tracks)this.tracks[t].audio.play().then(()=>console.log(`Playing track ${t}`)).catch(o=>console.error(`Error playing track ${t}: ${o.message}`));this.isPlaying=!0}).catch(t=>{console.error("Error preparing tracks for playback:",t)})},stopAllTracks(){for(let e in this.tracks){let t=this.tracks[e];t.audio.pause(),t.audio.currentTime=0}this.isPlaying=!1}};document.querySelectorAll("[data-play-button]").forEach(e=>{e.addEventListener("click",()=>{let t=e.closest(".track-controls");n.isPlaying?(n.stopAllTracks(),e.classList.remove("playing")):(n.loadSong(t),n.audioContext&&n.audioContext.state==="suspended"&&n.audioContext.resume().then(()=>console.log("AudioContext resumed")).catch(a=>console.error(`Error resuming AudioContext: ${a.message}`)),n.playAllTracks(),e.classList.add("playing"),d(t))})});function d(e){let t=e.querySelector("[data-track-url]");if(!t)return;let a=t.getAttribute("data-track-id"),o=n.tracks[a];if(!o)return;let r=o.audio,i=e.querySelector("[data-progress-bar]");i&&(r.addEventListener("timeupdate",()=>{if(r.duration){let s=r.currentTime/r.duration*100;i.value=s}}),i.addEventListener("input",s=>{if(!r.duration)return;let c=s.target.value/100*r.duration;for(let l in n.tracks)n.tracks[l].audio.currentTime=c}))}}document.addEventListener("DOMContentLoaded",()=>{document.querySelector("[data-mixer]")&&(console.log("Found mixer element, initializing..."),u())});})();
//# sourceMappingURL=main.js.map
